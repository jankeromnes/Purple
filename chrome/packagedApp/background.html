<!DOCTYPE html>
<!--
// Purple Extension 
//  part of the Purple project
// Copyright 2011 Google Inc. 
// see Purple/license.txt for BSD license
// johnjbarton@google.com
// Modified form http://src.chromium.org/viewvc/chrome/trunk/src/chrome/common/extensions/docs/examples/extensions/imageinfo/background.html?content-type=text/plain
// on 31AUG11
-->
<html>
  <head>
  </head>
  <body>
    <script>
      /**
       * Returns a handler which will open a new window when activated.
       */
      function getClickHandler() {
        return function(info, tab) {

          var createData = {url: 'ppa.html#' + tab.id, type: 'popup' };

          var width = parseInt(window.localStorage.getItem('windowWidth'));
          if (width) createData.width = width;

          var height = parseInt(window.localStorage.getItem('windowHeight'));
          if (width) createData.height = height;

          // Open Purple in a new window.
          chrome.windows.create(createData);
        };
      };

      /**
       * Create a context menu which will only show up on all pages
       */
      chrome.contextMenus.create({
        "title" : "Purple",
        "type" : "normal",
        "contexts" : ["page"],
        "onclick" : getClickHandler()
      });

      function checkForOrion(details) {
        var headers = details.responseHeaders;
        // ??
      }
  
      chrome.experimental.webRequest.onCompleted.addListener(checkForOrion, {types:['main_frame']}, ['responseHeaders']);
    </script>
  </body>
</html>
